using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public class TaskInteraction : MonoBehaviour
{
    [SerializeField] private float _range = 10.0f;
    private InteractibleCard _target;

    private void Awake(){
        StartCoroutine(SearchForInteraction());
    }

    private IEnumerator SearchForInteraction(){
        while(true){
            InteractibleCard newTarget = null;
            InteractibleCard[] interactionList = FindObjectsOfType<InteractibleCard>();

            UseButtonUI.Instance.HasInteractible = false;

            foreach(InteractibleCard interactible in interactionList){
                float distance = Vector3.Distance(transform.position, interactible.transform.position);
                if(distance > _range) { continue; }

                newTarget = interactible;
                UseButtonUI.Instance.HasInteractible = true;

                break;
            }

            if(UseButtonUI.Instance.CurrentInteractible != newTarget &&
               UseButtonUI.Instance.CurrentInteractible != null) {
               UseButtonUI.Instance.CurrentInteractible.Use(false);
            }

            _target = newTarget;
            UseButtonUI.Instance.CurrentInteractible = _target;

            yield return new WaitForSeconds(0.25f);
        }
    }
}
